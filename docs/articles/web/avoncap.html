<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="avoncap">
<title>Getting started • avoncap</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="avoncap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">avoncap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9028</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web/avoncap.html">Getting started</a>
    <a class="dropdown-item" href="../../articles/web/denominator-check.html">AvonCAP study population denominator</a>
    <a class="dropdown-item" href="../../articles/web/ed-data.html">The emergency department data set</a>
    <a class="dropdown-item" href="../../articles/web/gp-data.html">The primary care data set</a>
    <a class="dropdown-item" href="../../articles/web/longitudinal-pneumo.html">Pneumococcus longitudinal serotype data</a>
    <a class="dropdown-item" href="../../articles/web/quality-assurance.html">Quality assurance</a>
    <a class="dropdown-item" href="../../articles/web/uad-data.html">Pneumococcus urinary antigen data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started</h1>
            
      
      
      <div class="d-none name"><code>avoncap.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># The data input directory on my development machine:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"avoncap.input"</span> <span class="op">=</span> <span class="st">"~/Data/avoncap/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># library(avoncap)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">avoncap</span></span></span></code></pre></div>
<div class="section level2">
<h2 id="input-data-location">Input data location<a class="anchor" aria-label="anchor" href="#input-data-location"></a>
</h2>
<ul>
<li>first level directories.</li>
<li>Filenames need some indication of database year (either as
20-21,21-22,… or as y1,y2,…)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The data input directory on my development machine:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"avoncap.input"</span> <span class="op">=</span> <span class="st">"~/Data/avoncap/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The directory structure:</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/input.html">input</a></span><span class="op">(</span><span class="op">)</span>,glob<span class="op">=</span><span class="st">"*/cache/*"</span>,invert<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">/home/vp22681/Data/avoncap</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">avoncap-data-quality</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-08-07</span></span></span>
<span><span class="co">#&gt; │   │   └── confirmed-missing-2023-08-07.csv</span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">avoncap-export</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-03-22</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-06-20</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-07-11</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-09-21</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-10-07</span></span></span>
<span><span class="co">#&gt; │   │   └── uad-controls.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-11-09</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── uad-controls.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-03-02</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-05-02</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-06-12</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-06-16</span></span></span>
<span><span class="co">#&gt; │   │   └── uad-controls.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-06-28</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y3.csv</span></span>
<span><span class="co">#&gt; │   │   └── gp.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-07-24</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-09-13</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-11-20</span></span></span>
<span><span class="co">#&gt; │   │   └── ed_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-11-21</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── central_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-11-24</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y3.csv</span></span>
<span><span class="co">#&gt; │   │   └── ed_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2024-04-08</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y3.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y4.csv</span></span>
<span><span class="co">#&gt; │   │   └── ed_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2024-10-03</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y3.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y4.csv</span></span>
<span><span class="co">#&gt; │   │   └── ed_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── 22-23 codebook NBT.pdf</span></span>
<span><span class="co">#&gt; │   ├── 22-23 codebook UHBW.pdf</span></span>
<span><span class="co">#&gt; │   ├── Avon CAP - LRTD Patients 21-22 _ REDCap codebook.pdf</span></span>
<span><span class="co">#&gt; │   ├── Avon CAP - LRTD central database 20-21 _ REDCap.pdf</span></span>
<span><span class="co">#&gt; │   ├── AvonCAP Pneumococcus Codebook.pdf</span></span>
<span><span class="co">#&gt; │   ├── AvonCAP field validity.xlsx</span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── avoncap.yaml</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">cache</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">downloads</span></span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">ethnicity</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-07-12</span></span></span>
<span><span class="co">#&gt; │   │   ├── y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-10-27</span></span></span>
<span><span class="co">#&gt; │   │   ├── y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-06-07</span></span></span>
<span><span class="co">#&gt; │   │   ├── y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-11-22</span></span></span>
<span><span class="co">#&gt; │   │   ├── BRI_y2_extra.csv</span></span>
<span><span class="co">#&gt; │   │   ├── BRI_y3_extra.csv</span></span>
<span><span class="co">#&gt; │   │   ├── NBT_y2_extra.csv</span></span>
<span><span class="co">#&gt; │   │   ├── NBT_y3_extra.csv</span></span>
<span><span class="co">#&gt; │   │   ├── y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── y3.csv</span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">google-mobility</span></span></span>
<span><span class="co">#&gt; │   └── Global_Mobility_Report.csv</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">ltla-incidence</span></span></span>
<span><span class="co">#&gt; │   ├── ltla_2022-02-28.csv</span></span>
<span><span class="co">#&gt; │   └── ltla_2022-03-18.csv</span></span>
<span><span class="co">#&gt; ├── <span style="color: #BB0000; font-weight: bold;">maybe_some_useful_files_data.zip</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">metadata</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-10-24</span></span></span>
<span><span class="co">#&gt; │   │   ├── central_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── central_y3.csv</span></span>
<span><span class="co">#&gt; │   │   └── uad-controls.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-11-29</span></span></span>
<span><span class="co">#&gt; │   │   └── pneumococcal.csv</span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">metadata-review</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-10-25</span></span></span>
<span><span class="co">#&gt; │   │   └── metadata-review.csv</span></span>
<span><span class="co">#&gt; │   ├── AvonCAP 21-22 markred.xlsx</span></span>
<span><span class="co">#&gt; │   └── AvonCAP data dictionary - fields.csv</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">nhs-extract</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-07-11</span></span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y1.csv</span></span>
<span><span class="co">#&gt; │   │   └── deltave_NBT_y2.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-09-20</span></span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y3.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── deltave_NBT_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-11-16</span></span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y3.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── deltave_NBT_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-11-29</span></span></span>
<span><span class="co">#&gt; │   │   └── pneumococcal.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-11-30</span></span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y3.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── deltave_NBT_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-12-07</span></span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y2.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_BRI_y3.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y1.csv</span></span>
<span><span class="co">#&gt; │   │   ├── deltave_NBT_y2.csv</span></span>
<span><span class="co">#&gt; │   │   └── deltave_NBT_y3.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2022-12-20</span></span></span>
<span><span class="co">#&gt; │   │   └── ipd_avoncap_linkage.csv</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">2023-02-07</span></span></span>
<span><span class="co">#&gt; │   │   └── pneumococcal.csv</span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">old</span></span></span>
<span><span class="co">#&gt; │       ├── AdmissionDateByStudyNumber_2022-07-12.csv</span></span>
<span><span class="co">#&gt; │       └── DeltaVE_04042022.csv</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">spim-seroprevalence</span></span></span>
<span><span class="co">#&gt; │   └── week15_2022_seroprev_modellers.csv</span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">urine-antigens</span></span></span>
<span><span class="co">#&gt;     ├── <span style="color: #0000BB; font-weight: bold;">2022-09-15</span></span></span>
<span><span class="co">#&gt;     │   └── uad-cases.csv</span></span>
<span><span class="co">#&gt;     ├── <span style="color: #0000BB; font-weight: bold;">2023-05-15</span></span></span>
<span><span class="co">#&gt;     │   ├── gp-cases.csv</span></span>
<span><span class="co">#&gt;     │   └── uad-cases.csv</span></span>
<span><span class="co">#&gt;     ├── B1851202_SAP V1.0-27Sep2021_Final.pdf</span></span>
<span><span class="co">#&gt;     ├── README.md</span></span>
<span><span class="co">#&gt;     └── Table Template Serotype Distribution Scientific Affairs Proposal_FINAL.docx</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the most recent files</span></span>
<span><span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/most_recent_files.html">most_recent_files</a></span><span class="op">(</span><span class="st">"ethnicity"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 7</span></span></span>
<span><span class="co">#&gt;   filename     directory path            date       hospital study_year filetype</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fs::path&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BRI_y2_extra ethnicity …I_y2_extra.csv 2023-11-22 BRI               2 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> BRI_y3_extra ethnicity …I_y3_extra.csv 2023-11-22 BRI               3 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> NBT_y2_extra ethnicity …T_y2_extra.csv 2023-11-22 NBT               2 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> NBT_y3_extra ethnicity …T_y3_extra.csv 2023-11-22 NBT               3 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> y1           ethnicity …3-11-22/y1.csv 2023-11-22 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span> csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> y2           ethnicity …3-11-22/y2.csv 2023-11-22 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span> csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> y3           ethnicity …3-11-22/y3.csv 2023-11-22 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span> csv</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/load_data.html">load_data</a></span><span class="op">(</span><span class="st">"missing"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; No suitable files matching "missing", before date: 2024-10-07. Try one of: </span></span>
<span><span class="co">#&gt; as an input to 'type'</span></span>
<span><span class="co">#&gt; Error in avoncap::load_data("missing") : aborting.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-data-sources-and-recording-provenance">Load data sources and recording provenance<a class="anchor" aria-label="anchor" href="#load-data-sources-and-recording-provenance"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ethn</span> <span class="op">=</span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/load_data.html">load_data</a></span><span class="op">(</span><span class="st">"ethnicity"</span><span class="op">)</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/data-6c0a3f301ee14020e3907a7472c55225-767899bd2d292ad780aeb94b72046017.rda</span></span>
<span><span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/most_recent_files.html">most_recent_files</a></span><span class="op">(</span><span class="st">"nhs-extract"</span>,<span class="st">"deltave"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   filename       directory   path        date       hospital study_year filetype</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fs::path&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> deltave_BRI_y1 nhs-extract …BRI_y1.csv 2022-12-07 BRI               1 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> deltave_BRI_y2 nhs-extract …BRI_y2.csv 2022-12-07 BRI               2 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> deltave_BRI_y3 nhs-extract …BRI_y3.csv 2022-12-07 BRI               3 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> deltave_NBT_y1 nhs-extract …NBT_y1.csv 2022-12-07 NBT               1 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> deltave_NBT_y2 nhs-extract …NBT_y2.csv 2022-12-07 NBT               2 csv     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> deltave_NBT_y3 nhs-extract …NBT_y3.csv 2022-12-07 NBT               3 csv</span></span>
<span><span class="va">rawData</span> <span class="op">=</span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/load_data.html">load_data</a></span><span class="op">(</span><span class="st">"nhs-extract"</span>,<span class="st">"deltave"</span><span class="op">)</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/data-6c0a3f301ee14020e3907a7472c55225-efc310106a2b36fab3e67f93fe2c9461.rda</span></span>
<span><span class="co"># rawData = avoncap::load_data("nhs-extract","deltave",merge = FALSE)</span></span>
<span><span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/save_data_source_info.html">save_data_source_info</a></span><span class="op">(</span><span class="va">ethn</span>, <span class="va">rawData</span>, .file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"file-info"</span>,fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">#&gt;    path                                                                 md5     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/BRI_y2_extra.csv     030679d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/BRI_y3_extra.csv     e66fe88…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/NBT_y2_extra.csv     3726813…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/NBT_y3_extra.csv     afda520…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/y1.csv               270d33e…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/y2.csv               0a9ee3d…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> /home/vp22681/Data/avoncap/ethnicity/2023-11-22/y3.csv               3a4a048…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> /home/vp22681/Data/avoncap/nhs-extract/2022-12-07/deltave_BRI_y1.csv 66825a9…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> /home/vp22681/Data/avoncap/nhs-extract/2022-12-07/deltave_BRI_y2.csv cbd04cf…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> /home/vp22681/Data/avoncap/nhs-extract/2022-12-07/deltave_BRI_y3.csv b2fd072…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> /home/vp22681/Data/avoncap/nhs-extract/2022-12-07/deltave_NBT_y1.csv f61195e…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> /home/vp22681/Data/avoncap/nhs-extract/2022-12-07/deltave_NBT_y2.csv be0456b…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> /home/vp22681/Data/avoncap/nhs-extract/2022-12-07/deltave_NBT_y3.csv 49d5d4e…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normalising-data">Normalising data<a class="anchor" aria-label="anchor" href="#normalising-data"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_local(force=TRUE)</span></span>
<span><span class="va">normData</span> <span class="op">=</span> <span class="va">rawData</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/validate_data.html">validate_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%T&gt;%</span></span>
<span>  <span class="co"># note the magrittr `T` pipe above to drop the output of write issues</span></span>
<span>  <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/write_issues.html">write_issues</a></span><span class="op">(</span><span class="st">"issues.csv"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/normalise_data.html">normalise_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; validate data using: validate.nhs_extract.deltave</span></span>
<span><span class="co">#&gt; Normalising data using: normalise.nhs_extract.deltave</span></span>
<span><span class="co">#&gt; Some columns expected in the mappings were not present: consent_urine, consent_blood, consent_resp_samples1, what_was_the_first_surveil, admission_type, gp_practice, gp_practice_drop_down, hapcovid_screening, hospital_covid, np_swab, adm_np_type, np_date, days_adm_npswab, np_swab_2, adm_np_type_2, np_date_2, np_swab_3, adm_np_type_3, np_date_3, saliva, saliva_date, days_adm_saliva, sputum, sputum_date, days_adm_sputum, pt_ad_ur, adm_ur_taken, nourine_reason, adm_np_type_2, adm_ur_date, days_adm_urine, adm_serum_tak, adm_seru_date, days_adm_serum, adm_diagnosis, survive_1yr, survival_1yr_days, yr_survival_complete, confusion, abx_14d_prior, antibiotic_used, antiplatelets, anticoagulants, statins, hypertensives, antiviral_14d_prior</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/norm-0ef4812a2d1bc751062531c384a2b89e-007e47572d029d4d1474648ad7002896.rda</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapping-columns">Mapping columns<a class="anchor" aria-label="anchor" href="#mapping-columns"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Successfully mapped columns</span></span>
<span><span class="co"># attr(normData,"mapped")</span></span>
<span></span>
<span><span class="co"># Columns that are present in the normData but not mapped</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">normData</span>,<span class="st">"unmapped"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] ".spec_other_resp"    ".spec_other_cardiac" ".batch_code1"       </span></span>
<span><span class="co">#&gt; [4] ".batch_code2"        ".c19_compother"      ".batch_code3"       </span></span>
<span><span class="co">#&gt; [7] ".batch_code4"        ".batch_code5"</span></span>
<span></span>
<span><span class="co"># Columns not present in the normData for which mapping rules were supplied</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">normData</span>,<span class="st">"missing"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "consent_urine"              "consent_blood"             </span></span>
<span><span class="co">#&gt;  [3] "consent_resp_samples1"      "what_was_the_first_surveil"</span></span>
<span><span class="co">#&gt;  [5] "admission_type"             "gp_practice"               </span></span>
<span><span class="co">#&gt;  [7] "gp_practice_drop_down"      "hapcovid_screening"        </span></span>
<span><span class="co">#&gt;  [9] "hospital_covid"             "np_swab"                   </span></span>
<span><span class="co">#&gt; [11] "adm_np_type"                "np_date"                   </span></span>
<span><span class="co">#&gt; [13] "days_adm_npswab"            "np_swab_2"                 </span></span>
<span><span class="co">#&gt; [15] "adm_np_type_2"              "np_date_2"                 </span></span>
<span><span class="co">#&gt; [17] "np_swab_3"                  "adm_np_type_3"             </span></span>
<span><span class="co">#&gt; [19] "np_date_3"                  "saliva"                    </span></span>
<span><span class="co">#&gt; [21] "saliva_date"                "days_adm_saliva"           </span></span>
<span><span class="co">#&gt; [23] "sputum"                     "sputum_date"               </span></span>
<span><span class="co">#&gt; [25] "days_adm_sputum"            "pt_ad_ur"                  </span></span>
<span><span class="co">#&gt; [27] "adm_ur_taken"               "nourine_reason"            </span></span>
<span><span class="co">#&gt; [29] "adm_np_type_2"              "adm_ur_date"               </span></span>
<span><span class="co">#&gt; [31] "days_adm_urine"             "adm_serum_tak"             </span></span>
<span><span class="co">#&gt; [33] "adm_seru_date"              "days_adm_serum"            </span></span>
<span><span class="co">#&gt; [35] "adm_diagnosis"              "survive_1yr"               </span></span>
<span><span class="co">#&gt; [37] "survival_1yr_days"          "yr_survival_complete"      </span></span>
<span><span class="co">#&gt; [39] "confusion"                  "abx_14d_prior"             </span></span>
<span><span class="co">#&gt; [41] "antibiotic_used"            "antiplatelets"             </span></span>
<span><span class="co">#&gt; [43] "anticoagulants"             "statins"                   </span></span>
<span><span class="co">#&gt; [45] "hypertensives"              "antiviral_14d_prior"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="original-field-names-and-labels-">Original field names, and labels.<a class="anchor" aria-label="anchor" href="#original-field-names-and-labels-"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span></span>
<span><span class="co"># generate a set of readable label mappings from column to printable name for the whole normData set</span></span>
<span><span class="co"># overriding a particular label</span></span>
<span><span class="co"># readable_label_mapping(normData, demog.age="TEST")</span></span>
<span></span>
<span><span class="co"># Map a single column name as a string to a readable label</span></span>
<span><span class="fu"><a href="../../reference/readable_label.html">readable_label</a></span><span class="op">(</span><span class="st">"comorbid.previous_MI"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Previous MI"</span></span>
<span></span>
<span><span class="co"># get mapping from original field names pre-normalisation to</span></span>
<span><span class="co"># post normalisation fields</span></span>
<span><span class="fu"><a href="../../reference/original_field_names.html">original_field_names</a></span><span class="op">(</span><span class="va">normData</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                              consented </span></span>
<span><span class="co">#&gt;                                      "admin.consented" </span></span>
<span><span class="co">#&gt;                                                    ppc </span></span>
<span><span class="co">#&gt;                                   "admin.pp_consented" </span></span>
<span><span class="co">#&gt;                                             withdrawal </span></span>
<span><span class="co">#&gt;                                     "admin.withdrawal" </span></span>
<span><span class="co">#&gt;                                          record_number </span></span>
<span><span class="co">#&gt;                                  "admin.record_number" </span></span>
<span><span class="co">#&gt;                                        ac_study_number </span></span>
<span><span class="co">#&gt;                        "admin.consented_record_number" </span></span>
<span><span class="co">#&gt;                                             nhs_number </span></span>
<span><span class="co">#&gt;                             "admin.patient_identifier" </span></span>
<span><span class="co">#&gt;                                              duplicate </span></span>
<span><span class="co">#&gt;                                      "admin.duplicate" </span></span>
<span><span class="co">#&gt;                                        enrollment_date </span></span>
<span><span class="co">#&gt;                                "admin.enrollment_date" </span></span>
<span><span class="co">#&gt;                                             study_year </span></span>
<span><span class="co">#&gt;                                     "admin.study_year" </span></span>
<span><span class="co">#&gt;                                                   file </span></span>
<span><span class="co">#&gt;                                      "admin.data_file" </span></span>
<span><span class="co">#&gt;                                            week_number </span></span>
<span><span class="co">#&gt;                                    "admin.week_number" </span></span>
<span><span class="co">#&gt;                                          c19_diagnosis </span></span>
<span><span class="co">#&gt;           "diagnosis.standard_of_care_COVID_diagnosis" </span></span>
<span><span class="co">#&gt;                               clinical_radio_diagnosis </span></span>
<span><span class="co">#&gt; "diagnosis.clinical_or_radiological_LRTI_or_pneumonia" </span></span>
<span><span class="co">#&gt;                                           c19_adm_swab </span></span>
<span><span class="co">#&gt;                             "diagnosis.admission_swab" </span></span>
<span><span class="co">#&gt;                                          c19_test_type </span></span>
<span><span class="co">#&gt;                                  "diagnosis.test_type" </span></span>
<span><span class="co">#&gt;                              qualifying_symptoms_signs </span></span>
<span><span class="co">#&gt;                  "diagnosis.qualifying_symptoms_signs" </span></span>
<span><span class="co">#&gt;                                           cc_critieria </span></span>
<span><span class="co">#&gt;                "diagnosis.meets_case_control_criteria" </span></span>
<span><span class="co">#&gt;                                            cc_pos_date </span></span>
<span><span class="co">#&gt;             "diagnosis.first_COVID_positive_swab_date" </span></span>
<span><span class="co">#&gt;                                                 gender </span></span>
<span><span class="co">#&gt;                                         "demog.gender" </span></span>
<span><span class="co">#&gt;                                       age_at_admission </span></span>
<span><span class="co">#&gt;                                            "demog.age" </span></span>
<span><span class="co">#&gt;                                              age_march </span></span>
<span><span class="co">#&gt;                              "demog.age_in_march_2021" </span></span>
<span><span class="co">#&gt;                                                    imd </span></span>
<span><span class="co">#&gt;                                     "demog.imd_decile" </span></span>
<span><span class="co">#&gt;                                                smoking </span></span>
<span><span class="co">#&gt;                                         "demog.smoker" </span></span>
<span><span class="co">#&gt;                                             ethnicity2 </span></span>
<span><span class="co">#&gt;                                      "demog.ethnicity" </span></span>
<span><span class="co">#&gt;                                              care_home </span></span>
<span><span class="co">#&gt;                             "demog.care_home_resident" </span></span>
<span><span class="co">#&gt;                                              drugs___1 </span></span>
<span><span class="co">#&gt;                                  "demog.no_drug_abuse" </span></span>
<span><span class="co">#&gt;                                              drugs___2 </span></span>
<span><span class="co">#&gt;                                  "demog.alcohol_abuse" </span></span>
<span><span class="co">#&gt;                                              drugs___3 </span></span>
<span><span class="co">#&gt;                                     "demog.ivdu_abuse" </span></span>
<span><span class="co">#&gt;                                              drugs___4 </span></span>
<span><span class="co">#&gt;                                "demog.marijuana_abuse" </span></span>
<span><span class="co">#&gt;                                              drugs___5 </span></span>
<span><span class="co">#&gt;                       "demog.other_inhaled_drug_abuse" </span></span>
<span><span class="co">#&gt;                                                 vaping </span></span>
<span><span class="co">#&gt;                                         "demog.vaping" </span></span>
<span><span class="co">#&gt;                                              alc_units </span></span>
<span><span class="co">#&gt;                               "demog.units_of_alcohol" </span></span>
<span><span class="co">#&gt;                                       contraindication </span></span>
<span><span class="co">#&gt;            "vaccination.covid_vaccine_contraindicated" </span></span>
<span><span class="co">#&gt;                                            covid19_vax </span></span>
<span><span class="co">#&gt;                        "vaccination.covid_vaccination" </span></span>
<span><span class="co">#&gt;                                          covidvax_date </span></span>
<span><span class="co">#&gt;                          "vaccination.first_dose_date" </span></span>
<span><span class="co">#&gt;                                        covidvax_dose_2 </span></span>
<span><span class="co">#&gt;                         "vaccination.second_dose_date" </span></span>
<span><span class="co">#&gt;                                        covidvax_dose_3 </span></span>
<span><span class="co">#&gt;                          "vaccination.third_dose_date" </span></span>
<span><span class="co">#&gt;                                        covidvax_dose_4 </span></span>
<span><span class="co">#&gt;                         "vaccination.fourth_dose_date" </span></span>
<span><span class="co">#&gt;                                        covidvax_dose_5 </span></span>
<span><span class="co">#&gt;                          "vaccination.fifth_dose_date" </span></span>
<span><span class="co">#&gt;                                        covidvax_dose_6 </span></span>
<span><span class="co">#&gt;                          "vaccination.sixth_dose_date" </span></span>
<span><span class="co">#&gt;                             brand_of_covid19_vaccinati </span></span>
<span><span class="co">#&gt;                         "vaccination.first_dose_brand" </span></span>
<span><span class="co">#&gt;                                     covid19vax_brand_2 </span></span>
<span><span class="co">#&gt;                        "vaccination.second_dose_brand" </span></span>
<span><span class="co">#&gt;                                     covid19vax_brand_3 </span></span>
<span><span class="co">#&gt;                         "vaccination.third_dose_brand" </span></span>
<span><span class="co">#&gt;                                     covid19vax_brand_4 </span></span>
<span><span class="co">#&gt;                        "vaccination.fourth_dose_brand" </span></span>
<span><span class="co">#&gt;                                     covid19vax_brand_5 </span></span>
<span><span class="co">#&gt;                         "vaccination.fifth_dose_brand" </span></span>
<span><span class="co">#&gt;                                     covid19vax_brand_6 </span></span>
<span><span class="co">#&gt;                         "vaccination.sixth_dose_brand" </span></span>
<span><span class="co">#&gt;                                           c19vaxd1_adm </span></span>
<span><span class="co">#&gt;              "admission.time_since_first_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                           c19vaxd2_adm </span></span>
<span><span class="co">#&gt;             "admission.time_since_second_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                           c19vaxd3_adm </span></span>
<span><span class="co">#&gt;              "admission.time_since_third_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                           c19vaxd4_adm </span></span>
<span><span class="co">#&gt;             "admission.time_since_fourth_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                            c19vax5_adm </span></span>
<span><span class="co">#&gt;              "admission.time_since_fifth_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                            c19vax6_adm </span></span>
<span><span class="co">#&gt;              "admission.time_since_sixth_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                               flu_date </span></span>
<span><span class="co">#&gt;                       "vaccination.last_flu_dose_date" </span></span>
<span><span class="co">#&gt;                                          fluvax_adm_d1 </span></span>
<span><span class="co">#&gt;           "admission.time_since_last_flu_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                             ppv23_date </span></span>
<span><span class="co">#&gt;              "vaccination.last_pneumococcal_dose_date" </span></span>
<span><span class="co">#&gt;                                         ppv23vax_adm_d </span></span>
<span><span class="co">#&gt;  "admission.time_since_last_pneumococcal_vaccine_dose" </span></span>
<span><span class="co">#&gt;                                            c19_variant </span></span>
<span><span class="co">#&gt;                                      "genomic.variant" </span></span>
<span><span class="co">#&gt;                                                   year </span></span>
<span><span class="co">#&gt;                                       "admission.year" </span></span>
<span><span class="co">#&gt;                                             study_week </span></span>
<span><span class="co">#&gt;                                 "admission.study_week" </span></span>
<span><span class="co">#&gt;                                         admission_date </span></span>
<span><span class="co">#&gt;                                       "admission.date" </span></span>
<span><span class="co">#&gt;                                               hospital </span></span>
<span><span class="co">#&gt;                                       "admin.hospital" </span></span>
<span><span class="co">#&gt;                                                    ics </span></span>
<span><span class="co">#&gt;                 "admission.on_inhaled_corticosteroids" </span></span>
<span><span class="co">#&gt;                                                 immsup </span></span>
<span><span class="co">#&gt;                       "admission.on_immunosuppression" </span></span>
<span><span class="co">#&gt;                                              psi_class </span></span>
<span><span class="co">#&gt;             "admission.pneumonia_severity_index_class" </span></span>
<span><span class="co">#&gt;                                           crb_test_mai </span></span>
<span><span class="co">#&gt;                     "admission.curb_65_severity_score" </span></span>
<span><span class="co">#&gt;                                           news_2_total </span></span>
<span><span class="co">#&gt;                                "admission.news2_score" </span></span>
<span><span class="co">#&gt;                                               pulse_ox </span></span>
<span><span class="co">#&gt;                                   "admission.oximetry" </span></span>
<span><span class="co">#&gt;                                                     rr </span></span>
<span><span class="co">#&gt;                           "admission.respiratory_rate" </span></span>
<span><span class="co">#&gt;                                                   fio2 </span></span>
<span><span class="co">#&gt;                                 "admission.max_oxygen" </span></span>
<span><span class="co">#&gt;                                            systolic_bp </span></span>
<span><span class="co">#&gt;                                "admission.systolic_bp" </span></span>
<span><span class="co">#&gt;                                           diastolic_bp </span></span>
<span><span class="co">#&gt;                               "admission.diastolic_bp" </span></span>
<span><span class="co">#&gt;                                                     hr </span></span>
<span><span class="co">#&gt;                                 "admission.heart_rate" </span></span>
<span><span class="co">#&gt;                                            temperature </span></span>
<span><span class="co">#&gt;                                "admission.temperature" </span></span>
<span><span class="co">#&gt;                                  symptom_days_preadmit </span></span>
<span><span class="co">#&gt;                          "admission.duration_symptoms" </span></span>
<span><span class="co">#&gt;                                     previous_infection </span></span>
<span><span class="co">#&gt;                   "admission.previous_covid_infection" </span></span>
<span><span class="co">#&gt;                                 previousinfection_date </span></span>
<span><span class="co">#&gt;              "admission.previous_covid_infection_date" </span></span>
<span><span class="co">#&gt;                                            c19d_preadm </span></span>
<span><span class="co">#&gt;                 "admission.time_since_covid_diagnosis" </span></span>
<span><span class="co">#&gt;                                               rockwood </span></span>
<span><span class="co">#&gt;                             "admission.rockwood_score" </span></span>
<span><span class="co">#&gt;                                        cci_total_score </span></span>
<span><span class="co">#&gt;                 "admission.charlson_comorbidity_index" </span></span>
<span><span class="co">#&gt;                                                 height </span></span>
<span><span class="co">#&gt;                                     "admission.height" </span></span>
<span><span class="co">#&gt;                                                 weight </span></span>
<span><span class="co">#&gt;                                     "admission.weight" </span></span>
<span><span class="co">#&gt;                                                    bmi </span></span>
<span><span class="co">#&gt;                                        "admission.BMI" </span></span>
<span><span class="co">#&gt;                                        first_radio___1 </span></span>
<span><span class="co">#&gt;                                 "admission.cxr_normal" </span></span>
<span><span class="co">#&gt;                                        first_radio___2 </span></span>
<span><span class="co">#&gt;                              "admission.cxr_pneumonia" </span></span>
<span><span class="co">#&gt;                                        first_radio___3 </span></span>
<span><span class="co">#&gt;                          "admission.cxr_heart_failure" </span></span>
<span><span class="co">#&gt;                                        first_radio___4 </span></span>
<span><span class="co">#&gt;                       "admission.cxr_pleural_effusion" </span></span>
<span><span class="co">#&gt;                                        first_radio___5 </span></span>
<span><span class="co">#&gt;                          "admission.cxr_covid_changes" </span></span>
<span><span class="co">#&gt;                                        first_radio___6 </span></span>
<span><span class="co">#&gt;                                  "admission.cxr_other" </span></span>
<span><span class="co">#&gt;                                               c19_peep </span></span>
<span><span class="co">#&gt;                                       "day_7.max_peep" </span></span>
<span><span class="co">#&gt;                                            c19_hospadm </span></span>
<span><span class="co">#&gt;                                 "day_7.length_of_stay" </span></span>
<span><span class="co">#&gt;                                               c17_high </span></span>
<span><span class="co">#&gt;                                 "day_7.max_care_level" </span></span>
<span><span class="co">#&gt;                                               c19icuon </span></span>
<span><span class="co">#&gt;                                   "day_7.still_on_icu" </span></span>
<span><span class="co">#&gt;                                            c19_icudays </span></span>
<span><span class="co">#&gt;                             "day_7.icu_length_of_stay" </span></span>
<span><span class="co">#&gt;                                               c19_vent </span></span>
<span><span class="co">#&gt;                          "day_7.max_ventilation_level" </span></span>
<span><span class="co">#&gt;                                                 c19_ox </span></span>
<span><span class="co">#&gt;                                   "day_7.max_o2_level" </span></span>
<span><span class="co">#&gt;                                         c19_ionotropes </span></span>
<span><span class="co">#&gt;                              "day_7.ionotropes_needed" </span></span>
<span><span class="co">#&gt;                                   c19_complication___1 </span></span>
<span><span class="co">#&gt;                                             "day_7.PE" </span></span>
<span><span class="co">#&gt;                                   c19_complication___2 </span></span>
<span><span class="co">#&gt;                                            "day_7.DVT" </span></span>
<span><span class="co">#&gt;                                   c19_complication___3 </span></span>
<span><span class="co">#&gt;                                            "day_7.ARF" </span></span>
<span><span class="co">#&gt;                                   c19_complication___4 </span></span>
<span><span class="co">#&gt;                                         "day_7.NSTEMI" </span></span>
<span><span class="co">#&gt;                                   c19_complication___5 </span></span>
<span><span class="co">#&gt;                                          "day_7.STEMI" </span></span>
<span><span class="co">#&gt;                                   c19_complication___6 </span></span>
<span><span class="co">#&gt;                                "day_7.cardiac_failure" </span></span>
<span><span class="co">#&gt;                                   c19_complication___7 </span></span>
<span><span class="co">#&gt;                                         "day_7.new_AF" </span></span>
<span><span class="co">#&gt;                                   c19_complication___8 </span></span>
<span><span class="co">#&gt;                            "day_7.new_other_arrythmia" </span></span>
<span><span class="co">#&gt;                                   c19_complication___9 </span></span>
<span><span class="co">#&gt;                                 "day_7.inpatient_fall" </span></span>
<span><span class="co">#&gt;                                  c19_complication___10 </span></span>
<span><span class="co">#&gt;                             "day_7.other_complication" </span></span>
<span><span class="co">#&gt;                                  c19_complication___11 </span></span>
<span><span class="co">#&gt;                                "day_7.no_complication" </span></span>
<span><span class="co">#&gt;                                            c19_death7d </span></span>
<span><span class="co">#&gt;                                          "day_7.death" </span></span>
<span><span class="co">#&gt;                                           c19_meds___1 </span></span>
<span><span class="co">#&gt;                              "treatment.dexamethasone" </span></span>
<span><span class="co">#&gt;                                           c19_meds___2 </span></span>
<span><span class="co">#&gt;                                 "treatment.remdesevir" </span></span>
<span><span class="co">#&gt;                                           c19_meds___3 </span></span>
<span><span class="co">#&gt;                                "treatment.tocilizumab" </span></span>
<span><span class="co">#&gt;                                           c19_meds___4 </span></span>
<span><span class="co">#&gt;                                  "treatment.sarilumab" </span></span>
<span><span class="co">#&gt;                                           c19_meds___5 </span></span>
<span><span class="co">#&gt;                              "treatment.in_drug_trial" </span></span>
<span><span class="co">#&gt;                                           c19_meds___6 </span></span>
<span><span class="co">#&gt;                          "treatment.no_drug_treatment" </span></span>
<span><span class="co">#&gt;                                           c19_meds___7 </span></span>
<span><span class="co">#&gt;                                 "treatment.sotrovimab" </span></span>
<span><span class="co">#&gt;                                hospital_length_of_stay </span></span>
<span><span class="co">#&gt;                               "outcome.length_of_stay" </span></span>
<span><span class="co">#&gt;                                          survival_days </span></span>
<span><span class="co">#&gt;                            "outcome.survival_duration" </span></span>
<span><span class="co">#&gt;                                               ip_death </span></span>
<span><span class="co">#&gt;                              "outcome.inpatient_death" </span></span>
<span><span class="co">#&gt;                                            days_in_icu </span></span>
<span><span class="co">#&gt;                                 "outcome.icu_duration" </span></span>
<span><span class="co">#&gt;                             did_the_patient_have_respi </span></span>
<span><span class="co">#&gt;                   "outcome.respiratory_support_needed" </span></span>
<span><span class="co">#&gt;                             number_of_days_of_ventilat </span></span>
<span><span class="co">#&gt;                          "outcome.ventilator_duration" </span></span>
<span><span class="co">#&gt;                                               ett_days </span></span>
<span><span class="co">#&gt;                   "outcome.endotracheal_tube_duration" </span></span>
<span><span class="co">#&gt;                              renal_replacement_therapy </span></span>
<span><span class="co">#&gt;                       "outcome.renal_support_duration" </span></span>
<span><span class="co">#&gt;                                      complications___1 </span></span>
<span><span class="co">#&gt;                          "outcome.acute_renal_failure" </span></span>
<span><span class="co">#&gt;                                      complications___2 </span></span>
<span><span class="co">#&gt;                            "outcome.liver_dysfunction" </span></span>
<span><span class="co">#&gt;                                      complications___3 </span></span>
<span><span class="co">#&gt;                  "outcome.hospital_acquired_infection" </span></span>
<span><span class="co">#&gt;                                      complications___4 </span></span>
<span><span class="co">#&gt;          "outcome.acute_respiratory_distress_syndrome" </span></span>
<span><span class="co">#&gt;                                      complications___5 </span></span>
<span><span class="co">#&gt;                                       "outcome.NSTEMI" </span></span>
<span><span class="co">#&gt;                                      complications___6 </span></span>
<span><span class="co">#&gt;                                        "outcome.STEMI" </span></span>
<span><span class="co">#&gt;                                      complications___7 </span></span>
<span><span class="co">#&gt;                                       "outcome.new_AF" </span></span>
<span><span class="co">#&gt;                                      complications___8 </span></span>
<span><span class="co">#&gt;                          "outcome.new_other_arrhthmia" </span></span>
<span><span class="co">#&gt;                                      complications___9 </span></span>
<span><span class="co">#&gt;                                       "outcome.stroke" </span></span>
<span><span class="co">#&gt;                                     complications___10 </span></span>
<span><span class="co">#&gt;                                          "outcome.DVT" </span></span>
<span><span class="co">#&gt;                                     complications___11 </span></span>
<span><span class="co">#&gt;                                           "outcome.PE" </span></span>
<span><span class="co">#&gt;                                     complications___12 </span></span>
<span><span class="co">#&gt;                                "outcome.heart_failure" </span></span>
<span><span class="co">#&gt;                                     complications___13 </span></span>
<span><span class="co">#&gt;                             "outcome.fall_in_hospital" </span></span>
<span><span class="co">#&gt;                                     complications___14 </span></span>
<span><span class="co">#&gt;                             "outcome.reduced_mobility" </span></span>
<span><span class="co">#&gt;                                     complications___15 </span></span>
<span><span class="co">#&gt;                  "outcome.increasing_care_requirement" </span></span>
<span><span class="co">#&gt;                                     complications___16 </span></span>
<span><span class="co">#&gt;                             "outcome.no_complications" </span></span>
<span><span class="co">#&gt;                                    ventilatory_support </span></span>
<span><span class="co">#&gt;            "outcome.highest_level_ventilatory_support" </span></span>
<span><span class="co">#&gt;                             did_the_patient_receive_ec </span></span>
<span><span class="co">#&gt;                                "outcome.received_ecmo" </span></span>
<span><span class="co">#&gt;                             inotropic_support_required </span></span>
<span><span class="co">#&gt;                          "outcome.received_ionotropes" </span></span>
<span><span class="co">#&gt;                                       lrtd_30d_outcome </span></span>
<span><span class="co">#&gt;                            "outcome.functional_status" </span></span>
<span><span class="co">#&gt;                                                 fever2 </span></span>
<span><span class="co">#&gt;                         "symptom.abnormal_temperature" </span></span>
<span><span class="co">#&gt;                                            pleurtic_cp </span></span>
<span><span class="co">#&gt;                         "symptom.pleuritic_chest_pain" </span></span>
<span><span class="co">#&gt;                                                 cough2 </span></span>
<span><span class="co">#&gt;                                        "symptom.cough" </span></span>
<span><span class="co">#&gt;                                              sput_prod </span></span>
<span><span class="co">#&gt;                            "symptom.productive_sputum" </span></span>
<span><span class="co">#&gt;                                               dyspnoea </span></span>
<span><span class="co">#&gt;                                     "symptom.dyspnoea" </span></span>
<span><span class="co">#&gt;                                            tachypnoea2 </span></span>
<span><span class="co">#&gt;                                   "symptom.tachypnoea" </span></span>
<span><span class="co">#&gt;                                                anosmia </span></span>
<span><span class="co">#&gt;                                      "symptom.anosmia" </span></span>
<span><span class="co">#&gt;                                                ageusia </span></span>
<span><span class="co">#&gt;                                      "symptom.ageusia" </span></span>
<span><span class="co">#&gt;                                              dysgeusia </span></span>
<span><span class="co">#&gt;                                    "symptom.dysguesia" </span></span>
<span><span class="co">#&gt;                                                  fever </span></span>
<span><span class="co">#&gt;                                        "symptom.fever" </span></span>
<span><span class="co">#&gt;                                            hypothermia </span></span>
<span><span class="co">#&gt;                                  "symptom.hypothermia" </span></span>
<span><span class="co">#&gt;                                                 chills </span></span>
<span><span class="co">#&gt;                                       "symptom.chills" </span></span>
<span><span class="co">#&gt;                                               headache </span></span>
<span><span class="co">#&gt;                                     "symptom.headache" </span></span>
<span><span class="co">#&gt;                                                malaise </span></span>
<span><span class="co">#&gt;                                      "symptom.malaise" </span></span>
<span><span class="co">#&gt;                                                 wheeze </span></span>
<span><span class="co">#&gt;                                       "symptom.wheeze" </span></span>
<span><span class="co">#&gt;                                                myalgia </span></span>
<span><span class="co">#&gt;                                      "symptom.myalgia" </span></span>
<span><span class="co">#&gt;                                        worse_confusion </span></span>
<span><span class="co">#&gt;                          "symptom.worsening_confusion" </span></span>
<span><span class="co">#&gt;                                            general_det </span></span>
<span><span class="co">#&gt;                        "symptom.general_deterioration" </span></span>
<span><span class="co">#&gt;                                        ox_on_admission </span></span>
<span><span class="co">#&gt;                 "symptom.oxygen_required_on_admission" </span></span>
<span><span class="co">#&gt;                                       resp_disease___1 </span></span>
<span><span class="co">#&gt;                                  "comorbid.no_resp_dx" </span></span>
<span><span class="co">#&gt;                                       resp_disease___2 </span></span>
<span><span class="co">#&gt;                                        "comorbid.copd" </span></span>
<span><span class="co">#&gt;                                       resp_disease___3 </span></span>
<span><span class="co">#&gt;                                      "comorbid.asthma" </span></span>
<span><span class="co">#&gt;                                       resp_disease___4 </span></span>
<span><span class="co">#&gt;                                  "comorbid.resp_other" </span></span>
<span><span class="co">#&gt;                          other_respiratory_disease___1 </span></span>
<span><span class="co">#&gt;                              "comorbid.bronchiectasis" </span></span>
<span><span class="co">#&gt;                          other_respiratory_disease___2 </span></span>
<span><span class="co">#&gt;                        "comorbid.interstitial_lung_dx" </span></span>
<span><span class="co">#&gt;                          other_respiratory_disease___3 </span></span>
<span><span class="co">#&gt;                             "comorbid.cystic_fibrosis" </span></span>
<span><span class="co">#&gt;                          other_respiratory_disease___4 </span></span>
<span><span class="co">#&gt;                      "comorbid.pulmonary_hypertension" </span></span>
<span><span class="co">#&gt;                          other_respiratory_disease___5 </span></span>
<span><span class="co">#&gt;                          "comorbid.chronic_pleural_dx" </span></span>
<span><span class="co">#&gt;                          other_respiratory_disease___6 </span></span>
<span><span class="co">#&gt;                       "comorbid.other_chronic_resp_dx" </span></span>
<span><span class="co">#&gt;                                                chd___1 </span></span>
<span><span class="co">#&gt;                                 "comorbid.no_heart_dx" </span></span>
<span><span class="co">#&gt;                                                chd___2 </span></span>
<span><span class="co">#&gt;                                         "comorbid.ccf" </span></span>
<span><span class="co">#&gt;                                                chd___3 </span></span>
<span><span class="co">#&gt;                                         "comorbid.ihd" </span></span>
<span><span class="co">#&gt;                                                chd___4 </span></span>
<span><span class="co">#&gt;                                "comorbid.hypertension" </span></span>
<span><span class="co">#&gt;                                                chd___5 </span></span>
<span><span class="co">#&gt;                              "comorbid.other_heart_dx" </span></span>
<span><span class="co">#&gt;                                                     mi </span></span>
<span><span class="co">#&gt;                                 "comorbid.previous_mi" </span></span>
<span><span class="co">#&gt;                                          other_chd___1 </span></span>
<span><span class="co">#&gt;                         "comorbid.congenital_heart_dx" </span></span>
<span><span class="co">#&gt;                                          other_chd___2 </span></span>
<span><span class="co">#&gt;                                          "comorbid.af" </span></span>
<span><span class="co">#&gt;                                          other_chd___3 </span></span>
<span><span class="co">#&gt;                             "comorbid.other_arrythmia" </span></span>
<span><span class="co">#&gt;                                          other_chd___4 </span></span>
<span><span class="co">#&gt;                                   "comorbid.pacemaker" </span></span>
<span><span class="co">#&gt;                                          other_chd___5 </span></span>
<span><span class="co">#&gt;                           "comorbid.valvular_heart_dx" </span></span>
<span><span class="co">#&gt;                                          other_chd___6 </span></span>
<span><span class="co">#&gt;                        "comorbid.other_other_heart_dx" </span></span>
<span><span class="co">#&gt;                                               diabetes </span></span>
<span><span class="co">#&gt;                                    "comorbid.diabetes" </span></span>
<span><span class="co">#&gt;                                                dm_meds </span></span>
<span><span class="co">#&gt;                        "comorbid.diabetes_medications" </span></span>
<span><span class="co">#&gt;                               neurological_disease___1 </span></span>
<span><span class="co">#&gt;                                 "comorbid.neuro_other" </span></span>
<span><span class="co">#&gt;                               neurological_disease___2 </span></span>
<span><span class="co">#&gt;                                         "comorbid.cva" </span></span>
<span><span class="co">#&gt;                               neurological_disease___3 </span></span>
<span><span class="co">#&gt;                                         "comorbid.tia" </span></span>
<span><span class="co">#&gt;                               neurological_disease___4 </span></span>
<span><span class="co">#&gt;                                  "comorbid.hemiplegia" </span></span>
<span><span class="co">#&gt;                               neurological_disease___5 </span></span>
<span><span class="co">#&gt;                                  "comorbid.paraplegia" </span></span>
<span><span class="co">#&gt;                               neurological_disease___6 </span></span>
<span><span class="co">#&gt;                                 "comorbid.no_neuro_dx" </span></span>
<span><span class="co">#&gt;                                           dementia___1 </span></span>
<span><span class="co">#&gt;                                 "comorbid.no_dementia" </span></span>
<span><span class="co">#&gt;                                           dementia___2 </span></span>
<span><span class="co">#&gt;                                    "comorbid.dementia" </span></span>
<span><span class="co">#&gt;                                           dementia___3 </span></span>
<span><span class="co">#&gt;                        "comorbid.cognitive_impairment" </span></span>
<span><span class="co">#&gt;                                                 cancer </span></span>
<span><span class="co">#&gt;                                "comorbid.solid_cancer" </span></span>
<span><span class="co">#&gt;                                         haem_malig___1 </span></span>
<span><span class="co">#&gt;                    "comorbid.no_haemotological_cancer" </span></span>
<span><span class="co">#&gt;                                         haem_malig___2 </span></span>
<span><span class="co">#&gt;                                   "comorbid.leukaemia" </span></span>
<span><span class="co">#&gt;                                         haem_malig___3 </span></span>
<span><span class="co">#&gt;                                    "comorbid.lymphoma" </span></span>
<span><span class="co">#&gt;                                                    ckd </span></span>
<span><span class="co">#&gt;                                         "comorbid.ckd" </span></span>
<span><span class="co">#&gt;                                          liver_disease </span></span>
<span><span class="co">#&gt;                               "comorbid.liver_disease" </span></span>
<span><span class="co">#&gt;                                         gastric_ulcers </span></span>
<span><span class="co">#&gt;                              "comorbid.gastric_ulcers" </span></span>
<span><span class="co">#&gt;                                                    pvd </span></span>
<span><span class="co">#&gt;                              "comorbid.periph_vasc_dx" </span></span>
<span><span class="co">#&gt;                                                    ctd </span></span>
<span><span class="co">#&gt;                        "comorbid.connective_tissue_dx" </span></span>
<span><span class="co">#&gt;                                       immunodeficiency </span></span>
<span><span class="co">#&gt;                            "comorbid.immunodeficiency" </span></span>
<span><span class="co">#&gt;                                       other_pn_disease </span></span>
<span><span class="co">#&gt;                    "comorbid.other_pneumococcal_risks" </span></span>
<span><span class="co">#&gt;                                             transplant </span></span>
<span><span class="co">#&gt;                        "comorbid.transplant_recipient" </span></span>
<span><span class="co">#&gt;                                              pregnancy </span></span>
<span><span class="co">#&gt;                                   "comorbid.pregnancy" </span></span>
<span><span class="co">#&gt;                                                hiv___1 </span></span>
<span><span class="co">#&gt;                                      "comorbid.no_HIV" </span></span>
<span><span class="co">#&gt;                                                hiv___2 </span></span>
<span><span class="co">#&gt;                                         "comorbid.HIV" </span></span>
<span><span class="co">#&gt;                                                hiv___3 </span></span>
<span><span class="co">#&gt;                                        "comorbid.AIDS" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___1 </span></span>
<span><span class="co">#&gt;           "diagnosis.SOC_CAP_radiologically_confirmed" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___2 </span></span>
<span><span class="co">#&gt;               "diagnosis.SOC_CAP_clinically_confirmed" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___3 </span></span>
<span><span class="co">#&gt;                       "diagnosis.SOC_CAP_no_radiology" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___4 </span></span>
<span><span class="co">#&gt;                                   "diagnosis.SOC_LRTI" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___5 </span></span>
<span><span class="co">#&gt;                     "diagnosis.SOC_Empyema_or_abscess" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___6 </span></span>
<span><span class="co">#&gt;                      "diagnosis.SOC_exacerbation_COPD" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___7 </span></span>
<span><span class="co">#&gt;                  "diagnosis.SOC_exacerbation_non_COPD" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___8 </span></span>
<span><span class="co">#&gt;               "diagnosis.SOC_congestive_heart_failure" </span></span>
<span><span class="co">#&gt;                           final_soc_lrtd_diagnosis___9 </span></span>
<span><span class="co">#&gt;                 "diagnosis.SOC_non_infectious_process" </span></span>
<span><span class="co">#&gt;                          final_soc_lrtd_diagnosis___10 </span></span>
<span><span class="co">#&gt;                               "diagnosis.SOC_non_LRTI" </span></span>
<span><span class="co">#&gt;                                     covid_19_diagnosis </span></span>
<span><span class="co">#&gt;                         "diagnosis.covid_19_diagnosis" </span></span>
<span><span class="co">#&gt;                                                  ppv23 </span></span>
<span><span class="co">#&gt;                                "vaccination.pneumovax" </span></span>
<span><span class="co">#&gt;                                            flu_vaccine </span></span>
<span><span class="co">#&gt;                    "vaccination.influenza_vaccination"</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># unname(readable_label_mapping(normData))</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="augmenting-the-ve-extract-data">Augmenting the VE extract data<a class="anchor" aria-label="anchor" href="#augmenting-the-ve-extract-data"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span><span class="va">augData</span> <span class="op">=</span> <span class="va">normData</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/augment_data.html">augment_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Augmenting data using: augment.nhs_extract.deltave</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/augment-4c0c0c577381837fb7b8ee36b440288a-d981ec047773880ae6d2795d43fa2887.rda</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-and-normalising-the-central-database">loading and normalising the central database<a class="anchor" aria-label="anchor" href="#loading-and-normalising-the-central-database"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rawData2</span> <span class="op">=</span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/load_data.html">load_data</a></span><span class="op">(</span><span class="st">"avoncap-export"</span>,<span class="st">"central"</span>, merge<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/data-6c0a3f301ee14020e3907a7472c55225-d3d605f1b753e8667f640743669191d4.rda</span></span>
<span><span class="co"># without merge: currently: INCONSISTENT COLUMN(S) IN FILES: sars_cov2_antigen</span></span>
<span><span class="co"># due to the fact it is mostly a numeric but some values "&gt;250"</span></span>
<span></span>
<span><span class="co"># devtools::load_all()</span></span>
<span></span>
<span><span class="va">failures</span> <span class="op">=</span> <span class="va">rawData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/validate_data.html">validate_data</a></span><span class="op">(</span><span class="op">)</span>  <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/write_issues.html">write_issues</a></span><span class="op">(</span><span class="st">"~/avoncap-issues"</span><span class="op">)</span></span>
<span><span class="co">#&gt; validate data using: validate.avoncap_export.central</span></span>
<span><span class="co">#&gt; non-finite value in consented in 7 rows</span></span>
<span><span class="co">#&gt; non-finite value in ppc in 7 rows</span></span>
<span><span class="co">#&gt; non-finite value in include_patient in 9 rows</span></span>
<span><span class="co">#&gt; non-finite value in hosp in 14 rows</span></span>
<span><span class="co">#&gt; non-finite value in withdrawal in 51 rows</span></span>
<span><span class="co">#&gt; missing value in systolic_bp in 1 rows</span></span>
<span><span class="co">#&gt; missing value in diastolic_bp in 1 rows</span></span>
<span><span class="co">#&gt; missing value in imd in 456 rows</span></span>
<span><span class="co">#&gt; missing value in hypertensives in 8 rows</span></span>
<span><span class="co">#&gt; missing value in statins in 8 rows</span></span>
<span><span class="co">#&gt; missing value in anticoagulants in 8 rows</span></span>
<span><span class="co">#&gt; missing value in antiplatelets in 8 rows</span></span>
<span><span class="co">#&gt; missing columns: ethnicity in 1 rows</span></span>
<span><span class="co">#&gt; non-finite value in news_2_total in 29 rows</span></span>
<span><span class="co">#&gt; non-finite value in care_home in 1 rows</span></span>
<span><span class="co">#&gt; non-finite value in ckd in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in liver_disease in 3 rows</span></span>
<span><span class="co">#&gt; non-finite value in diabetes in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in gastric_ulcers in 3 rows</span></span>
<span><span class="co">#&gt; non-finite value in pvd in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in ctd in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in immunodeficiency in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in other_pn_disease in 4 rows</span></span>
<span><span class="co">#&gt; non-finite value in cancer in 1 rows</span></span>
<span><span class="co">#&gt; non-finite value in transplant in 3 rows</span></span>
<span><span class="co">#&gt; non-finite value in hospital_length_of_stay in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in covid_19_diagnosis in 1 rows</span></span>
<span><span class="co">#&gt; non-finite value in lrtd_30d_outcome in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in week_number in 911 rows</span></span>
<span><span class="co">#&gt; non-finite value in highest_level_care_require in 1 rows</span></span>
<span><span class="co">#&gt; non-finite value in ventilatory_support in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in psi_class in 1 rows</span></span>
<span><span class="co">#&gt; non-finite value in fever2 in 2 rows</span></span>
<span><span class="co">#&gt; non-finite value in gp_practice_drop_down in 128 rows</span></span>
<span><span class="co">#&gt; missing value in final_soc_lrtd_diagnosis in 1 rows</span></span>
<span><span class="co">#&gt; both pneumonia and NP-LRTI in final SOC dx in 6 rows</span></span>
<span><span class="co">#&gt; 30 day and 1 yr survival duration different in 1 rows</span></span>
<span><span class="co">#&gt; length of stay &gt; 30 day survival duration in 7 rows</span></span>
<span><span class="co">#&gt; length of stay &gt; 1 yr survival duration in 31 rows</span></span>
<span><span class="co">#&gt; marked as died lrtd_30d_outcome but survival_days &gt; 30 days in 3 rows</span></span>
<span><span class="co">#&gt; non-finite value in dm_meds in 68 rows</span></span>
<span><span class="co">#&gt; non-finite value in current in 4 rows</span></span>
<span><span class="co">#&gt; non-finite value in pregnancy in 5 rows</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/data-6c0a3f301ee14020e3907a7472c55225-7498859e4eaf9f364dc024b6ee4039c2.rda</span></span>
<span></span>
<span><span class="va">normData2</span> <span class="op">=</span> <span class="va">rawData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/normalise_data.html">normalise_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Normalising data using: normalise.avoncap_export.central</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/data-6c0a3f301ee14020e3907a7472c55225-767899bd2d292ad780aeb94b72046017.rda</span></span>
<span><span class="co">#&gt; Admission date is derived from study week and hence approximate.</span></span>
<span><span class="co">#&gt; Some columns expected in the mappings were not present: nhs_number, np_swab_3, adm_np_type_3, covidvax_date, covidvax_dose_2, covidvax_dose_3, covidvax_dose_4, covidvax_dose_5, covidvax_dose_6, flu_date, ppv23_date, previousinfection_date</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/norm-0ef4812a2d1bc751062531c384a2b89e-4f99cf58ecb2f420c40b2a44fb58478d.rda</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">=</span> <span class="va">failures</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.error_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none checked in checkbox"</span>,<span class="st">"missing value"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">.variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"consented"</span>,<span class="st">"ppc"</span>,<span class="st">"include_patient"</span>,<span class="st">"hosp"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">inner_join</span><span class="op">(</span><span class="va">rawData2</span>, by<span class="op">=</span><span class="st">"record_number"</span>, suffix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>,<span class="st">".raw"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">.variable</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">20</span><span class="op">)</span></span>
<span>  </span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">tmp</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">enrollment_date</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">hosp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">scale_x_date</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%m-%Y"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x.bottom <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">.variable</span>,scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"No quality checked variables with more than 20 missing items (excluding consent flags)"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="avoncap_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normMicro</span> <span class="op">=</span> <span class="va">rawData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/normalise_data.html">normalise_data</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">"micro"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Normalising data using: normalise.avoncap_export.central.micro</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/norm-b1452b07c5b368fef65b90881bbe0087-b6ac10b16cc535a89abacf663f0fdb41.rda</span></span>
<span></span>
<span><span class="va">normMicro</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">micro.test_performed</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">micro.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">micro.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pathogen</span>,<span class="va">detected</span>,  useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                   detected</span></span>
<span><span class="co">#&gt; pathogen                              no   yes  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Aspergillus                      39846    25     0</span></span>
<span><span class="co">#&gt;   Streptococcus Agalactiae         39858    13     0</span></span>
<span><span class="co">#&gt;   Candida                          38930   941     0</span></span>
<span><span class="co">#&gt;   Achromobacter Xylosoxidans       39855    16     0</span></span>
<span><span class="co">#&gt;   Bacteroides                      39867     4     0</span></span>
<span><span class="co">#&gt;   Bacteroides fragilis             39862     9     0</span></span>
<span><span class="co">#&gt;   Bacteroides ovatus               39871     0     0</span></span>
<span><span class="co">#&gt;   Bacteroides uniformis            39871     0     0</span></span>
<span><span class="co">#&gt;   Burholderia cepacia              39867     4     0</span></span>
<span><span class="co">#&gt;   Citrobacter freundii complex     39842    29     0</span></span>
<span><span class="co">#&gt;   Citrobacter koseri               39827    44     0</span></span>
<span><span class="co">#&gt;   Clostridium perfringens          39859    12     0</span></span>
<span><span class="co">#&gt;   Eggerthella lenta                39871     0     0</span></span>
<span><span class="co">#&gt;   Enterobacter aerogenes           39862     9     0</span></span>
<span><span class="co">#&gt;   Enterobacter cloacae             39745   126     0</span></span>
<span><span class="co">#&gt;   Enterococcus faecalis            39802    69     0</span></span>
<span><span class="co">#&gt;   Enterococcus faecium             39827    44     0</span></span>
<span><span class="co">#&gt;   Escherichia coli                 39246   625     0</span></span>
<span><span class="co">#&gt;   Haemophilus influenzae           39250   621     0</span></span>
<span><span class="co">#&gt;   Haemophilus parainfluenzae       39868     3     0</span></span>
<span><span class="co">#&gt;   Klebsiella oxytoca               39794    77     0</span></span>
<span><span class="co">#&gt;   Klebsiella pneumoniae            39649   222     0</span></span>
<span><span class="co">#&gt;   Morganella morganii              39861    10     0</span></span>
<span><span class="co">#&gt;   Peptostreptococcus anaerobius    39870     1     0</span></span>
<span><span class="co">#&gt;   Proteus mirabilis                39794    77     0</span></span>
<span><span class="co">#&gt;   Pseudomonas aeruginosa           39361   510     0</span></span>
<span><span class="co">#&gt;   Serratia marcescens              39807    64     0</span></span>
<span><span class="co">#&gt;   Staphylcoccus aureus             39348   523     0</span></span>
<span><span class="co">#&gt;   Streptococcus anginosus          39859    12     0</span></span>
<span><span class="co">#&gt;   Streptococcus pneumoniae         39593   278     0</span></span>
<span><span class="co">#&gt;   Streptococcus salivarius group   39865     6     0</span></span>
<span><span class="co">#&gt;   Stenotrophomonas maltophilia     39802    69     0</span></span>
<span><span class="co">#&gt;   Acinetobacter                    39849    22     0</span></span>
<span><span class="co">#&gt;   Aspergillus niger                39871     0     0</span></span>
<span><span class="co">#&gt;   Bacillus                         39853    18     0</span></span>
<span><span class="co">#&gt;   Candida albicans                 39840    31     0</span></span>
<span><span class="co">#&gt;   Candida glabrata                 39864     7     0</span></span>
<span><span class="co">#&gt;   Candida tropicalis               39865     6     0</span></span>
<span><span class="co">#&gt;   Coagulase negative staphylcoccus 39850    21     0</span></span>
<span><span class="co">#&gt;   Corynebacterium                  39844    27     0</span></span>
<span><span class="co">#&gt;   Enterococcus                     39866     5     0</span></span>
<span><span class="co">#&gt;   Gram positive coccus             39827    44     0</span></span>
<span><span class="co">#&gt;   Klebsiella                       39841    30     0</span></span>
<span><span class="co">#&gt;   Legionella pneumoniae            39869     2     0</span></span>
<span><span class="co">#&gt;   MRSA                             39848    23     0</span></span>
<span><span class="co">#&gt;   MSSA                             39870     1     0</span></span>
<span><span class="co">#&gt;   Moraxella catarrhalis            39735   136     0</span></span>
<span><span class="co">#&gt;   Mycobacterium tuberculosis       39863     8     0</span></span>
<span><span class="co">#&gt;   Pneumocytis jirovecii            39869     2     0</span></span>
<span><span class="co">#&gt;   Pseudomonas                      39752   119     0</span></span>
<span><span class="co">#&gt;   Pseudomonas fluorescens          39870     1     0</span></span>
<span><span class="co">#&gt;   Staphylcoccus                    39844    27     0</span></span>
<span><span class="co">#&gt;   Staphylococcus capitis           39797    74     0</span></span>
<span><span class="co">#&gt;   Staphylococcus epidermidis       39480   391     0</span></span>
<span><span class="co">#&gt;   Staphylococcus hominis           39648   223     0</span></span>
<span><span class="co">#&gt;   Streptococcus                    39846    25     0</span></span>
<span><span class="co">#&gt;   Streptococcus beta-hemolytic     39770   101     0</span></span>
<span><span class="co">#&gt;   Streptococcus pyogenes           39854    17     0</span></span>
<span><span class="co">#&gt;   Streptococcus viridans           39871     0     0</span></span>
<span><span class="co">#&gt;   Yeast                            39830    41     0</span></span>
<span><span class="co">#&gt;   Other                            39057   814     0</span></span>
<span><span class="co">#&gt;   &lt;NA&gt;                                 0     0     0</span></span>
<span><span class="va">normMicro</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">micro.test_performed</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">micro.test_type</span>, <span class="va">micro.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">micro.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">detected</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">group_by</span><span class="op">(</span><span class="va">pathogen</span>, <span class="va">micro.test_type</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 206 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   pathogen, micro.test_type [206]</span></span></span>
<span><span class="co">#&gt;    pathogen                   micro.test_type     n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Candida                    Sputum            655</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Haemophilus influenzae     Sputum            522</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Other                      Blood culture     441</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Escherichia coli           Blood culture     425</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Staphylococcus epidermidis Blood culture     380</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Pseudomonas aeruginosa     Sputum            343</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Other                      Sputum            263</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Staphylcoccus aureus       Blood culture     223</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Staphylococcus hominis     Blood culture     220</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Staphylcoccus aureus       Sputum            169</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 196 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normVirol</span> <span class="op">=</span> <span class="va">rawData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/normalise_data.html">normalise_data</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">"virol"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Normalising data using: normalise.avoncap_export.central.virol</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/norm-b6f8ed1851f16d8282d50544e149e955-b6ac10b16cc535a89abacf663f0fdb41.rda</span></span>
<span></span>
<span><span class="va">normVirol</span>  <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">virol.test_performed</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">virol.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">virol.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pathogen</span>,<span class="va">detected</span>,  useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                          detected</span></span>
<span><span class="co">#&gt; pathogen                                     no   yes  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Influenza A                             85076  1173     0</span></span>
<span><span class="co">#&gt;   Influenza B                             86191    58     0</span></span>
<span><span class="co">#&gt;   RSV                                     85789   460     0</span></span>
<span><span class="co">#&gt;   Adenovirus                              86213    36     0</span></span>
<span><span class="co">#&gt;   Human Metapneumovirus                   85858   391     0</span></span>
<span><span class="co">#&gt;   Human Rhinovirus/Enterovirus            85435   814     0</span></span>
<span><span class="co">#&gt;   Parainfluenza Type 1                    86225    24     0</span></span>
<span><span class="co">#&gt;   Parainfluenza Type 2                    86235    14     0</span></span>
<span><span class="co">#&gt;   Parainfluenza Type 3                    86008   241     0</span></span>
<span><span class="co">#&gt;   Parainfluenza Type 4                    86178    71     0</span></span>
<span><span class="co">#&gt;   Covid-19                                69104 17145     0</span></span>
<span><span class="co">#&gt;   Other                                   86197    52     0</span></span>
<span><span class="co">#&gt;   Coronavirus 229E                        86243     6     0</span></span>
<span><span class="co">#&gt;   Coronavirus HKU1                        86241     8     0</span></span>
<span><span class="co">#&gt;   Coronavirus NL63                        86243     6     0</span></span>
<span><span class="co">#&gt;   Coronavirus OC43                        86231    18     0</span></span>
<span><span class="co">#&gt;   Middle East Respiratory Syndrome (MERS) 86249     0     0</span></span>
<span><span class="co">#&gt;   Bordetella parapertussis (IS1001)       86248     1     0</span></span>
<span><span class="co">#&gt;   Bordetella pertussis (ptxP)             86247     2     0</span></span>
<span><span class="co">#&gt;   Chlamydia pneumoniae                    86246     3     0</span></span>
<span><span class="co">#&gt;   Mycoplasma pneumoniae                   86226    23     0</span></span>
<span><span class="co">#&gt;   &lt;NA&gt;                                        0     0     0</span></span>
<span><span class="va">normVirol</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">virol.test_performed</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">virol.test_type</span>, <span class="va">virol.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">virol.pathogen</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">detected</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># with(table(pathogen, virol.test_type,  useNA = "always")) %&gt;% </span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">pathogen</span>, <span class="va">virol.test_type</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 61 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   pathogen, virol.test_type [61]</span></span></span>
<span><span class="co">#&gt;    pathogen                     virol.test_type               n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Covid-19                     PCR - COVID only           <span style="text-decoration: underline;">9</span>024</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Covid-19                     POCT Test (Abbott)         <span style="text-decoration: underline;">5</span>341</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Covid-19                     PCR Respiratory (Biofire)  <span style="text-decoration: underline;">1</span>708</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Covid-19                     PCR Quad Panel              785</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Human Rhinovirus/Enterovirus PCR Respiratory (Biofire)   549</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Influenza A                  PCR Respiratory (Biofire)   446</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Influenza A                  PCR Quad Panel              323</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Influenza A                  PCR - Respiratory panel     251</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Human Rhinovirus/Enterovirus PCR - Respiratory panel     246</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Human Metapneumovirus        PCR Respiratory (Biofire)   245</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 51 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normRadio</span> <span class="op">=</span> <span class="va">rawData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/normalise_data.html">normalise_data</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">"radio"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Normalising data using: normalise.avoncap_export.central.radio</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/norm-ebbd016b214d0a4b408623ae4e2c8e3c-b6ac10b16cc535a89abacf663f0fdb41.rda</span></span>
<span></span>
<span><span class="co"># old format tmp3  %&gt;% filter(radio.test_performed=="yes") %&gt;% with(table(radio.test_type, radio.lung_malignancy))</span></span>
<span><span class="va">normRadio</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">radio.test_performed</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">radio.alrtd_finding</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">radio.alrtd_finding</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">finding</span>,<span class="va">present</span>,  useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                   present</span></span>
<span><span class="co">#&gt; finding                               no   yes  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Normal                           42065 31593    28</span></span>
<span><span class="co">#&gt;   Consistent with pneumonia        48771 24887    28</span></span>
<span><span class="co">#&gt;   Consistent with heart failure    67483  6175    28</span></span>
<span><span class="co">#&gt;   Consistent with pleural effusion 58606 15052    28</span></span>
<span><span class="co">#&gt;   Consistent with COVID-19         67329  6329    28</span></span>
<span><span class="co">#&gt;   Other abnormal finding           68289  5369    28</span></span>
<span><span class="co">#&gt;   &lt;NA&gt;                                 0     0     0</span></span>
<span><span class="va">normRadio</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">radio.test_performed</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">radio.test_type</span>, <span class="va">radio.non_alrtd_finding</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">radio.non_alrtd_finding</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">present</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">finding</span>, <span class="va">radio.test_type</span>,  useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                        radio.test_type</span></span>
<span><span class="co">#&gt; finding                                  CXR CT scan (CT thorax, CTPA, HRCT)</span></span>
<span><span class="co">#&gt;   Pulmonary embolus                      249                             999</span></span>
<span><span class="co">#&gt;   Pneumothorax and/or pneumomediastinum 1362                             263</span></span>
<span><span class="co">#&gt;   Cavity including abscesses              63                              48</span></span>
<span><span class="co">#&gt;   Aspergillioma                            5                               4</span></span>
<span><span class="co">#&gt;   Lung malignancy                        557                             465</span></span>
<span><span class="co">#&gt;   Lung nodules                           595                             772</span></span>
<span><span class="co">#&gt;   Tuberculosis (old or new)               18                               6</span></span>
<span><span class="co">#&gt;   Empyema                                190                             206</span></span>
<span><span class="co">#&gt;   &lt;NA&gt;                                     0                               0</span></span>
<span><span class="co">#&gt;                                        radio.test_type</span></span>
<span><span class="co">#&gt; finding                                 US thorax  MRI Other &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Pulmonary embolus                             0    0    21    0</span></span>
<span><span class="co">#&gt;   Pneumothorax and/or pneumomediastinum         0    0     0    0</span></span>
<span><span class="co">#&gt;   Cavity including abscesses                    0    0     0    0</span></span>
<span><span class="co">#&gt;   Aspergillioma                                 0    0     0    0</span></span>
<span><span class="co">#&gt;   Lung malignancy                               0    0     2    0</span></span>
<span><span class="co">#&gt;   Lung nodules                                  0    0     1    0</span></span>
<span><span class="co">#&gt;   Tuberculosis (old or new)                     0    0     0    0</span></span>
<span><span class="co">#&gt;   Empyema                                       0    0     4    0</span></span>
<span><span class="co">#&gt;   &lt;NA&gt;                                          0    0     0    0</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normHaem</span> <span class="op">=</span> <span class="va">rawData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/normalise_data.html">normalise_data</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">"haem"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Normalising data using: normalise.avoncap_export.central.haem</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/norm-0ef4812a2d1bc751062531c384a2b89e-21d15cd212a32c17f9825910553b13aa.rda</span></span>
<span><span class="va">augHaem</span> <span class="op">=</span> <span class="va">normHaem</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/augment_data.html">augment_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Augmenting data using: augment.avoncap_export.central.haem</span></span>
<span><span class="co">#&gt; using cached item: ~/.cache/avoncap/augment-4c0c0c577381837fb7b8ee36b440288a-ccba24d52b63e86cece394b7a8426a76.rda</span></span>
<span></span>
<span><span class="va">augHaem</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">haem.troponin_level</span>, <span class="va">haem.d_dimer_level</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   haem.troponin_level</span></span>
<span><span class="co">#&gt; haem.d_dimer_level   ≤18   &gt;18 Unknown</span></span>
<span><span class="co">#&gt;            ≤0.5      351    64     319</span></span>
<span><span class="co">#&gt;            &gt;0.5      943   596    1054</span></span>
<span><span class="co">#&gt;            Unknown  7018  7906   25068</span></span>
<span><span class="va">augHaem</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">haem.crp_level</span>, <span class="va">haem.white_cell_count_level</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            haem.crp_level</span></span>
<span><span class="co">#&gt; haem.white_cell_count_level   &lt;10 10-50   &gt;50 Unknown</span></span>
<span><span class="co">#&gt;                     ≤10      6948  8248  6805     419</span></span>
<span><span class="co">#&gt;                     &gt;10      3550  5758 10997     182</span></span>
<span><span class="co">#&gt;                     Unknown    22    22    24     344</span></span>
<span></span>
<span><span class="co"># x = augHaem %&gt;% summary()</span></span>
<span><span class="co"># t(x)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="augmenting-the-central-database">Augmenting the central database<a class="anchor" aria-label="anchor" href="#augmenting-the-central-database"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span><span class="va">augData2</span> <span class="op">=</span> <span class="va">normData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">avoncap</span><span class="fu">::</span><span class="fu"><a href="../../reference/augment_data.html">augment_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Augmenting data using: augment.avoncap_export.central</span></span>
<span><span class="co">#&gt; caching item: ~/.cache/avoncap/augment-4c0c0c577381837fb7b8ee36b440288a-b76bba6c10bb223ab293d7996d868036.rda</span></span>
<span><span class="co">#&gt; Created outcome.admitted_to_hospital using:</span></span>
<span><span class="co">#&gt; Created demog.age_category, demog.age_eligible, admission.cci_category, admission.cci_category_alternate, admission.rockwood_category, admission.curb_65_category using: demog.age, admission.charlson_comorbidity_index, admission.rockwood_score, admission.curb_65_severity_score</span></span>
<span><span class="co">#&gt; Created admin.patient_identifier using: admin.first_record_number, admin.record_number</span></span>
<span><span class="co">#&gt; Created admission.episode, admission.interval using: admission.date</span></span>
<span><span class="co">#&gt; Skipping function due to error: In argument: `admin.linked_gp_practice = ~...`.</span></span>
<span><span class="co">#&gt; Created admin.catchment_status using: admin.gp_practice</span></span>
<span><span class="co">#&gt; Created comorbid.diabetes_type, comorbid.solid_cancer_present, comorbid.haemotological_cancer_present, comorbid.any_cancer_present, comorbid.any_chronic_lung_disease, comorbid.any_chronic_heart_disease, comorbid.cva_or_tia, comorbid.any_immune_compromise using: comorbid.diabetes, comorbid.solid_cancer, comorbid.leukaemia, comorbid.lymphoma, comorbid.no_haemotological_cancer, comorbid.asthma, comorbid.bronchiectasis, comorbid.chronic_pleural_dx, comorbid.copd, comorbid.interstitial_lung_dx, comorbid.cystic_fibrosis, comorbid.other_chronic_resp_dx, comorbid.pulmonary_hypertension, comorbid.ccf, comorbid.ihd, comorbid.previous_mi, comorbid.congenital_heart_dx, comorbid.hypertension, comorbid.af, comorbid.other_arrythmia, comorbid.other_heart_dx, comorbid.other_other_heart_dx, comorbid.cva, comorbid.tia, comorbid.immunodeficiency, admission.on_immunosuppression</span></span>
<span><span class="co">#&gt; Created admission.initial_presentation_3_class using: admission.presumed_CAP_clinically_confirmed, admission.presumed_CAP_radiologically_confirmed, admission.presumed_CAP_no_radiology, admission.presumed_Empyema_or_abscess, admission.presumed_LRTI, admission.presumed_exacerbation_COPD, admission.presumed_exacerbation_non_COPD, admission.presumed_congestive_heart_failure</span></span>
<span><span class="co">#&gt; Created admission.hospital_acquired, admission.days_before_enrollment using: admission.hospital_acquired_covid, admission.non_lrtd_hospital_acquired_covid, admission.date, admin.enrollment_date</span></span>
<span><span class="co">#&gt; Created admission.covid_pcr_result, admission.is_covid using: diagnosis.covid_19_diagnosis, diagnosis.admission_swab, diagnosis.test_type</span></span>
<span><span class="co">#&gt; Created diagnosis.pneumonia, diagnosis.LRTI, diagnosis.exacerbation_of_chronic_respiratory_disease, diagnosis.heart_failure using: diagnosis.SOC_CAP_clinically_confirmed, diagnosis.SOC_CAP_radiologically_confirmed, diagnosis.SOC_CAP_no_radiology, diagnosis.SOC_Empyema_or_abscess, admission.cxr_pneumonia, diagnosis.SOC_LRTI, diagnosis.SOC_exacerbation_COPD, diagnosis.SOC_exacerbation_non_COPD, diagnosis.SOC_congestive_heart_failure</span></span>
<span><span class="co">#&gt; Created admission.infective_cause using: diagnosis.SOC_non_infectious_process, diagnosis.SOC_non_LRTI</span></span>
<span><span class="co">#&gt; Created admission.category, admission.presentation_3_class using:</span></span>
<span><span class="co">#&gt; Created diagnosis.infection_context using: admission.hospital_acquired_covid, admission.non_lrtd_hospital_acquired_covid, diagnosis.first_COVID_positive_swab_date, admission.date</span></span>
<span><span class="co">#&gt; Created genomic.variant_inferred using: genomic.variant, admission.date</span></span>
<span><span class="co">#&gt; Created symptom_onset.date_of_symptoms, symptom_onset.time_of_symptoms_since_first_vaccine_dose, symptom_onset.time_of_symptoms_since_second_vaccine_dose, symptom_onset.time_of_symptoms_since_third_vaccine_dose, symptom_onset.time_of_symptoms_since_fourth_vaccine_dose, vaccination.dose_interval, vaccination.booster_interval, vaccination.second_booster_interval using: admission.date, admission.duration_symptoms, admission.time_since_first_vaccine_dose, admission.time_since_second_vaccine_dose, admission.time_since_third_vaccine_dose, admission.time_since_fourth_vaccine_dose</span></span>
<span><span class="co">#&gt; Created vaccination.protection using: vaccination.covid_vaccination, admission.time_since_fourth_vaccine_dose, admission.duration_symptoms, admission.time_since_third_vaccine_dose, admission.time_since_second_vaccine_dose, admission.time_since_first_vaccine_dose, admission.previous_covid_infection</span></span>
<span><span class="co">#&gt; Created vaccination.vaccination using: vaccination.covid_vaccination, admission.time_since_sixth_vaccine_dose, admission.duration_symptoms, admission.time_since_fifth_vaccine_dose, admission.time_since_fourth_vaccine_dose, admission.time_since_third_vaccine_dose, admission.time_since_second_vaccine_dose, admission.time_since_first_vaccine_dose</span></span>
<span><span class="co">#&gt; Created vaccination.brand_combination using: vaccination.first_dose_brand, vaccination.second_dose_brand, vaccination.third_dose_brand</span></span>
<span><span class="co">#&gt; Created pneumo.presentation_CAP, pneumo.presentation_RAD, pneumo.presentation_class using: diagnosis.SOC_CAP_radiologically_confirmed</span></span>
<span><span class="co">#&gt; Created admission.pneumococcal_high_risk using: demog.age, comorbid.other_pneumococcal_risks, comorbid.copd, comorbid.interstitial_lung_dx, comorbid.cystic_fibrosis, comorbid.hypertension, comorbid.ccf, comorbid.ihd, comorbid.ckd, comorbid.liver_disease, comorbid.diabetes, comorbid.immunodeficiency, comorbid.asthma, admission.on_immunosuppression</span></span>
<span><span class="co">#&gt; Created admission.pneumococcal_risk_classification using: comorbid.cva, comorbid.immunodeficiency, comorbid.leukaemia, comorbid.lymphoma, comorbid.no_haemotological_cancer, admission.on_immunosuppression, comorbid.transplant_recipient, comorbid.ckd, comorbid.HIV, comorbid.solid_cancer, demog.care_home_resident, demog.smoker, demog.age, demog.alcohol_abuse, comorbid.diabetes, comorbid.diabetes_medications, comorbid.paraplegia, comorbid.copd, comorbid.interstitial_lung_dx, comorbid.cystic_fibrosis, comorbid.asthma, comorbid.liver_disease, comorbid.ccf, comorbid.ihd, comorbid.other_pneumococcal_risks</span></span>
<span><span class="co">#&gt; Created day_7.WHO_clinical_progression, outcome.WHO_clinical_progression using: day_7.death, day_7.max_ventilation_level, day_7.ionotropes_needed, day_7.max_o2_level, outcome.survival_duration, outcome.functional_status, outcome.highest_level_ventilatory_support, outcome.received_ionotropes, outcome.respiratory_support_needed</span></span>
<span><span class="co">#&gt; Created outcome.icu_admission, outcome.death_within_30_days, outcome.death_within_1_year, outcome.death_during_follow_up using: outcome.icu_duration, day_7.death, outcome.survival_duration, outcome.one_year_survival_duration, outcome.one_year_survival_complete, outcome.inpatient_death, outcome.functional_status</span></span>
<span><span class="co">#&gt; Created survival.length_of_stay, survival.uncensored_time_to_death, survival.last_observed_event using: admin.enrollment_date, outcome.length_of_stay, outcome.survival_duration, outcome.one_year_survival_duration, admission.date</span></span>
<span><span class="co">#&gt; Created survival.length_of_stay_category, survival.30_day_death_time, survival.30_day_death_event, survival.1_yr_death_time, survival.1_yr_death_event, survival.30_day_discharge_time, survival.30_day_discharge_event using:</span></span>
<span><span class="co">#&gt; Created survival.length_of_stay_quintile using:</span></span>
<span><span class="co">#&gt; Created day_7.max_o2_gt_28, day_7.max_o2_gt_35, day_7.max_o2_gt_50, day_7.WHO_score_gt_6, day_7.WHO_score_gt_5, day_7.los_gt_3, day_7.los_gt_5, day_7.los_gt_7 using: day_7.max_o2_level, day_7.length_of_stay, outcome.survival_duration</span></span>
<span><span class="co">#&gt; Created  using:</span></span>
<span><span class="co">#&gt; Created admission.pre_admission_antivirals_given using: admission.pre_admission_antiviral</span></span>
<span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admission.category</span>,  <span class="va">admission.presentation_3_class</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               admission.category</span></span>
<span><span class="co">#&gt; admission.presentation_3_class Confirmed SARS-CoV-2 No evidence SARS-CoV-2</span></span>
<span><span class="co">#&gt;               Pneumonia                        6038                  14882</span></span>
<span><span class="co">#&gt;               NP-LRTI                          5820                   9406</span></span>
<span><span class="co">#&gt;               No evidence LRTI                   75                      0</span></span>
<span><span class="co">#&gt;               &lt;NA&gt;                                0                      0</span></span>
<span><span class="co">#&gt;                               admission.category</span></span>
<span><span class="co">#&gt; admission.presentation_3_class Non-infective  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;               Pneumonia                    0     0</span></span>
<span><span class="co">#&gt;               NP-LRTI                      0     0</span></span>
<span><span class="co">#&gt;               No evidence LRTI          7098     0</span></span>
<span><span class="co">#&gt;               &lt;NA&gt;                         0  2158</span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admission.covid_pcr_result</span>,  <span class="va">admission.presentation_3_class</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               admission.covid_pcr_result</span></span>
<span><span class="co">#&gt; admission.presentation_3_class SARS-CoV-2 PCR negative SARS-CoV-2 PCR positive</span></span>
<span><span class="co">#&gt;               Pneumonia                          13482                    5981</span></span>
<span><span class="co">#&gt;               NP-LRTI                             8291                    5741</span></span>
<span><span class="co">#&gt;               No evidence LRTI                    5690                      62</span></span>
<span><span class="co">#&gt;               &lt;NA&gt;                                   0                       0</span></span>
<span><span class="co">#&gt;                               admission.covid_pcr_result</span></span>
<span><span class="co">#&gt; admission.presentation_3_class  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;               Pneumonia         1457</span></span>
<span><span class="co">#&gt;               NP-LRTI           1194</span></span>
<span><span class="co">#&gt;               No evidence LRTI  1421</span></span>
<span><span class="co">#&gt;               &lt;NA&gt;              2158</span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admission.infective_cause</span>,  <span class="va">admission.presentation_3_class</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               admission.infective_cause</span></span>
<span><span class="co">#&gt; admission.presentation_3_class Non-infective Infective  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;               Pneumonia                    0     20920     0</span></span>
<span><span class="co">#&gt;               NP-LRTI                      0     15226     0</span></span>
<span><span class="co">#&gt;               No evidence LRTI          7098        75     0</span></span>
<span><span class="co">#&gt;               &lt;NA&gt;                         0         0  2158</span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admission.infective_cause</span>,  <span class="va">admission.is_covid</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         admission.infective_cause</span></span>
<span><span class="co">#&gt; admission.is_covid       Non-infective Infective  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Confirmed SARS-CoV-2               0     11933     0</span></span>
<span><span class="co">#&gt;   No evidence SARS-CoV-2          7098     24288     0</span></span>
<span><span class="co">#&gt;   &lt;NA&gt;                               0         0  2158</span></span>
<span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admin.consent_withheld</span>, <span class="va">admission.presentation_3_class</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               admin.consent_withheld</span></span>
<span><span class="co">#&gt; admission.presentation_3_class    no   yes</span></span>
<span><span class="co">#&gt;               Pneumonia        20920     0</span></span>
<span><span class="co">#&gt;               NP-LRTI          15226     0</span></span>
<span><span class="co">#&gt;               No evidence LRTI  7173     0</span></span>
<span><span class="co">#&gt;               &lt;NA&gt;                 0  2158</span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admin.consent_withheld</span>, <span class="va">admin.catchment_status</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       admin.consent_withheld</span></span>
<span><span class="co">#&gt; admin.catchment_status    no   yes</span></span>
<span><span class="co">#&gt;   Bristol area         39216     0</span></span>
<span><span class="co">#&gt;   Outside Bristol area  3975     0</span></span>
<span><span class="co">#&gt;   No GP details          128  2158</span></span>
<span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../../reference/xglimpse.html">xglimpse</a></span><span class="op">(</span><span class="va">admin.consented</span>, <span class="va">admin.catchment_status</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       admin.consented</span></span>
<span><span class="co">#&gt; admin.catchment_status Not approached   Yes Declined consent  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   Bristol area                  19516 19700                0     0</span></span>
<span><span class="co">#&gt;   Outside Bristol area           1933  2042                0     0</span></span>
<span><span class="co">#&gt;   No GP details                   201   130             1948     7</span></span>
<span></span>
<span></span>
<span><span class="va">augData2</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">admission.pre_admission_antivirals_given</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">unnest</span><span class="op">(</span><span class="va">admission.pre_admission_antiviral</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">given</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># with(table(pathogen, virol.test_type,  useNA = "always")) %&gt;% </span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">antiviral</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   antiviral [5]</span></span></span>
<span><span class="co">#&gt;   antiviral                    n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Other                    <span style="text-decoration: underline;">30</span>169</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Oseltamivir or Zanamivir    31</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Paxlovid                     9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Sotrovimab                   6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Molnupiravir                 3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rob Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
