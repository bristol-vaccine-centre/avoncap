<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sanitise AvonCap data columns — normalise_data • avoncap</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sanitise AvonCap data columns — normalise_data" />
<meta property="og:description" content="AvonCap data has lots of columns which are named in a difficult to remember fashion, composed of
data items that have enumerated values with no semantics. This makes displaying them difficult and
any filtering done on the raw data inscrutable. Depending on the source of the data some different columns
may be present due to differences in the NHS and UoB data sets. The redcap database has some options that may be
checklists and some that are radio buttons, both of these end up with mysterious names in the data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">avoncap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/avoncap.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sanitise AvonCap data columns</h1>
    
    <div class="hidden name"><code>normalise_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>AvonCap data has lots of columns which are named in a difficult to remember fashion, composed of
data items that have enumerated values with no semantics. This makes displaying them difficult and
any filtering done on the raw data inscrutable. Depending on the source of the data some different columns
may be present due to differences in the NHS and UoB data sets. The redcap database has some options that may be
checklists and some that are radio buttons, both of these end up with mysterious names in the data.</p>
    </div>

    <pre class="usage"><span class='fu'>normalise_data</span><span class='op'>(</span>
  <span class='va'>rawData</span>,
  ethn <span class='op'>=</span> <span class='kw'><a href='https://rdrr.io/r/base/try.html'>try</a></span><span class='op'>(</span><span class='fu'>avoncap</span><span class='fu'>::</span><span class='fu'><a href='load_data.html'>load_data</a></span><span class='op'>(</span><span class='st'>"ethnicity"</span>, reproduce_at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>, silent <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  remove_mapped <span class='op'>=</span> <span class='cn'>TRUE</span>,
  remove_unmapped <span class='op'>=</span> <span class='cn'>TRUE</span>,
  mappings <span class='op'>=</span> <span class='va'>.mappings</span>,
  messages <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"files: {files}"</span>, <span class='st'>"{.total} rows"</span>, <span class='st'>"analysis date: {reproduce_at}"</span>,
    <span class='st'>"files from: {date}"</span><span class='op'>)</span>,
  reproduce_at <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"reproduce.at"</span>, default <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  data_source_info <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rawData</th>
      <td><ul>
<li><p>the raw data from <code><a href='load_data.html'>load_data()</a></code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>ethn</th>
      <td><p>the supplementary ethnicity files. but default will use the call <code><a href='most_recent_files.html'>avoncap::most_recent_files("ethnicity")</a></code> to find these files and will- can be set to "NULL" if ethnicity files are not available.</p></td>
    </tr>
    <tr>
      <th>remove_mapped</th>
      <td><p>gets rid of original columns for which we have a mapping (leaving the new versions)</p></td>
    </tr>
    <tr>
      <th>remove_unmapped</th>
      <td><p>gets rid of columns for which we do not have a mapping</p></td>
    </tr>
    <tr>
      <th>mappings</th>
      <td><p>a set of mappings (see <code>zzz-avoncap-mappings.R</code>)</p></td>
    </tr>
    <tr>
      <th>messages</th>
      <td><p>a set of <code>dtrackr</code> glue specs that populate the first box fo the flow chart. (can use <code>{files}</code>, <code>{reproduce_at}</code>, <code>{date}</code>, <code>{.total}</code>)</p></td>
    </tr>
    <tr>
      <th>reproduce_at</th>
      <td><p>the date at which to reproduce the analysis to (<code><a href='https://rdrr.io/r/base/options.html'>options(reproduce.at = "...")</a></code>)</p></td>
    </tr>
    <tr>
      <th>data_source_info</th>
      <td><ul>
<li><p>if not null a filename, and the function will write out a file with the details of the input files used.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>passed onto <code><a href='https://rdrr.io/pkg/ggrrr/man/cached.html'>ggrrr::cached(...)</a></code>. e.g. <code>nocache = TRUE</code> can be used to defeat caching.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a tracked dataframe with</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function maps the data into a tidy dataframe with consistently named columns, and named factors where appropriate.
If not present in the data the ethnicity files
Most of the sanitisation code is held in the <code>zzz-avoncap-mappings.R</code> file.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rob Challen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


